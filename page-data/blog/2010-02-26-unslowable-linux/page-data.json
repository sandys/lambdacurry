{"componentChunkName":"component---src-templates-blog-post-js","path":"/blog/2010-02-26-unslowable-linux/","result":{"data":{"site":{"siteMetadata":{"title":"Lambdacurry"}},"markdownRemark":{"id":"aa6c93c9-f1d9-5716-9e31-beef2c0a1fb8","excerpt":"For the past week, I have tuned my linux installation to be unslowable - it honors my available RAM and swap and if memory goes low, any new processes terminate…","html":"<p>For the past week, I have tuned my linux installation to be unslowable - it honors my available RAM and swap and if memory goes low, any new processes terminate rather than thrash (inherently slowing down my system) There is a bit of tuning involved in this: the key parameters involved are  (in <em>/etc/sysctl.conf</em></p>\n<p>)</p>\n<blockquote>\n<p>﻿﻿﻿﻿﻿﻿vm.overcommit_memory and vm.overcommit_ratio</p>\n</blockquote>\n<p>These variables control the behavior of memory allocation and the amount of memory being legally allowed to be requested. <em>overcommit_memory</em> controls the behavior of memory allocation (which, at the end of the day happens through <em>sbrk</em>). Setting it to 2, indicates that if the system is out of memory, then <em>malloc</em> should return null.</p>\n<p>Surprisingly, this is <strong>not</strong> the default behavior - it relies on the fact that a program may request 100mb but it is only using 50mb at any given time. Therefore a system has more memory than its swap + RAM.</p>\n<p>This does not always play well with heavy loads on a machine - especially 20 tabs browser with flash + Ruby server processes + MySQL. This particular setting means that individual processes may terminate rather than hanging your machine, but you will never have an unresponsive system.</p>\n<p>Setting this to 100 gives you exactly RAM + Swap. This is highly pessimistic, since it is true that a lot of processes demand more memory than they need. I have had best results on my machine (with 2GB RAM and 1GB swap) by setting it to 200.</p>\n<p><em>overcommit_ratio</em> is the amount of memory that can be requested by your system. With <em>overcommit_memory</em> as 2, this turns out to be:</p>\n<blockquote>\n<p>CommitLimit = (RAM * (overcommit_ratio / 100)) + Swap</p>\n</blockquote>\n<p>Using these settings, I can run a browser with multiple tabs, Ruby servers, MySQL and a few other processes. I will be playing with this number to account for heavy duty VirtualBox, etc. But essentially it tells me the point at which my system will slow down… the better solution is to add more RAM (which I cant in my old laptop… waiting for newer laptops with nVidia and USB 3.0 !) .. but that is a whole different story.</p>","frontmatter":{"title":"Unslowable Linux","date":"February 26, 2010"}}},"pageContext":{"slug":"/blog/2010-02-26-unslowable-linux/","previous":{"fields":{"slug":"/blog/2010-01-30-32-bit-compile-on-64-bit-ubuntu-not-finding-stdc-libs/"},"frontmatter":{"title":"32 bit compile on 64-bit ubuntu, not finding stdc++ libs"}},"next":{"fields":{"slug":"/blog/2010-03-02-the-internet-at-risk/"},"frontmatter":{"title":"The internet at risk"}}}},"staticQueryHashes":["2778469899","2841359383","2882394463","3616023293"]}